!function r(e,t,n){function o(a,c){if(!t[a]){if(!e[a]){var p="function"==typeof require&&require;if(!c&&p)return p(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var s=t[a]={exports:{}};e[a][0].call(s.exports,function(r){var t=e[a][1][r];return o(t?t:r)},s,s.exports,r,e,t,n)}return t[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(r,e,t){(function(r){"use strict";var t={mxcrypto:"1.0.0",__:void 0,str2ab:function(r){for(var e=new Uint8Array(r.length),t=0,n=r.length;t<n;++t)e[t]=r.charCodeAt(t);return e.buffer},ab2str:function(e){return r.String.fromCharCode.apply(null,new Uint8Array(e))},str2hex:function(r){for(var e="",t=0,n=r.length;t<n;t++)e+=("00"+r.charCodeAt(t).toString(16)).slice(-2);return e},hex2str:function(e){var t="";e=e.match(/.{2}/g)||[];for(var n=0,o=e.length;n<o;n++)t+=r.String.fromCharCode(parseInt(e[n],16));return t},objExtract:function(r,e){var t={};for(var n in e)e[n]in r&&(t[e[n]]=r[e[n]]);return t},generateAesKey:function(){var e=arguments.length<=0||void 0===arguments[0]?128:arguments[0],t=arguments.length<=1||void 0===arguments[1]||arguments[1];return r.crypto.subtle.generateKey({name:"AES-GCM",length:e},t,["encrypt","decrypt","wrapKey","unwrapKey"])["catch"](function(r){console.error("Error generating AES-GCM key:",r)})},importAesKey:function(e){return r.crypto.subtle.importKey("raw",new Uint8Array(e),{name:"AES-GCM"},!1,["encrypt","decrypt","wrapKey","unwrapKey"])["catch"](function(r){console.error("Error importing AES-GCM key:",r)})},generateRsaKeys:function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];return r.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},e,["encrypt","decrypt","wrapKey","unwrapKey"])["catch"](function(r){console.error("Error generating RSA-OAEP keys:",r)})},exportRsaKeys:function(e,t){var n=this;if(!(e.privateKey instanceof r.CryptoKey&&e.publicKey instanceof r.CryptoKey&&t instanceof r.CryptoKey))return r.Promise.reject("rsaKeys must be an RSA keypair (or must be stored)");var o=r.crypto.getRandomValues(new Uint8Array(t.algorithm.length/8));return Promise.all([r.crypto.subtle.wrapKey("jwk",e.privateKey,t,{name:t.algorithm.name,iv:o}).then(function(r){return{iv:n.ab2str(o),key:n.ab2str(r)}}),r.crypto.subtle.exportKey("jwk",e.publicKey)]).then(function(r){return{privateKey:r[0],publicKey:r[1]}})["catch"](function(r){console.error("Error exporting RSA-OAEP keys:",r)})},importRsaKeys:function(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0],t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];if(!e.iv&&!e.alg)return r.Promise.reject("1st argument must be a private or public key");if(e.iv&&!(t instanceof r.CryptoKey))return r.Promise.reject("2nd argument must be a CryptoKey");if(n&&!n.alg)return r.Promise.reject("3rd argument (if present) must be a public key");var o=[];e.iv&&o.push(r.crypto.subtle.unwrapKey("jwk",this.str2ab(e.key),t,{name:t.algorithm.name,iv:this.str2ab(e.iv)},{name:"RSA-OAEP",hash:{name:"SHA-256"}},!1,["decrypt","unwrapKey"])["catch"](function(r){console.error("Error unwrapping RSA-OAEP private key:",r)}));var i=void 0;return((i=e).alg||(i=n)&&i.alg)&&o.push(r.crypto.subtle.importKey("jwk",i,{name:"RSA-OAEP",hash:{name:"SHA-256"}},i.ext,i.key_ops)["catch"](function(r){console.error("Error importing RSA-OAEP public key:",r)})),Promise.all(o).then(function(r){return{privateKey:"private"==r[0].type?r[0]:null,publicKey:"public"==r[r.length-1].type?r[r.length-1]:null}})["catch"](function(r){console.error("Error importing RSA-OAEP key pair:",r)})},wrapKey:function(e,t){var n=this,o={},i=null;if("public"==t.type)o=t.algorithm;else{if("secret"!=t.type)return Promise.reject("wrappingKey not supported (only public or secret)");i=r.crypto.getRandomValues(new Uint8Array(t.algorithm.length/8)),o={name:t.algorithm.name,iv:i}}return r.crypto.subtle.wrapKey("jwk",e,t,o).then(function(r){var t={wrapping:n.objExtract(o,["name","length","hash","iv"]),wrapped:n.objExtract(e.algorithm,["name","length","hash"]),data:n.ab2str(r)};return t.wrapped.usages=e.usages,"iv"in t.wrapping&&(t.wrapping.iv=n.ab2str(t.wrapping.iv)),t})["catch"](function(r){console.error("Error wrapping key:",r)})},unwrapKey:function(e,t){return"iv"in e.wrapping&&(e.wrapping.iv=this.str2ab(e.wrapping.iv)),r.crypto.subtle.unwrapKey("jwk",this.str2ab(e.data),t,e.wrapping,e.wrapped,!1,e.wrapped.usages)["catch"](function(r){console.error("Error unwrapping key:",r)})},encrypt:function(e,t){var n=this,o={},i=null;if("public"==t.type)o=t.algorithm;else{if("secret"!=t.type)return Promise.reject("key not supported (only public or secret)");i=r.crypto.getRandomValues(new Uint8Array(t.algorithm.length/8)),o={name:t.algorithm.name,iv:i}}return r.crypto.subtle.encrypt(o,t,this.str2ab(e)).then(function(r){var e={algo:n.objExtract(o,["name","length","hash","iv"]),data:n.ab2str(r)};return"iv"in e.algo&&(e.algo.iv=n.ab2str(e.algo.iv)),e})["catch"](function(r){console.error("Error encrypting cleartext:",r)})},decrypt:function(e,t){var n=this;return"iv"in e.algo&&(e.algo.iv=this.str2ab(e.algo.iv)),r.crypto.subtle.decrypt(e.algo,t,this.str2ab(e.data)).then(function(r){return n.ab2str(r)})["catch"](function(r){console.error("Error decrypting cipherdata:",r)})},init:function(){if(!r)throw new Error("A global/window object is needed");r.crypto&&r.crypto.subtle||console.error("WebCrypto isn't available"),r.__&&void 0===r.__.mxcrypto&&(this.__=r.__),r.__=this},noConflict:function(){void 0!==this.__&&(r.__=this.__,this.__=void 0)}};t.init(),e&&e.exports&&(e.exports=t)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);